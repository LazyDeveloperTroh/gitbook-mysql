---
description: >-
  MySQL 서버로 요청된 쿼리는 결과는 동이랗지만 내부적으로 그 결과를 만들어내는 방법은 매우 다양하다. 옵티마이저는 이런 다양한 방법
  중에서 어떤 방법이 최적이고 최소의 비용이 소모될지 판단하여 최적의 실행 계획을 수립하는 역할을 한다.
---

# 옵티마이저 & 힌트

### 쿼리 실행 절차

<mark style="background-color:blue;">MySQL 서버에서 쿼리가 실행되는 과정은 크게 세 단계로 나눌 수 있다.</mark>

1. 사용자로부터 요청된 SQL 문장을 잘게 쪼개서 MySQL 서버가 이해할 수 있는 수준으로 분리한다. \
   (파스 트리)
2. SQL 파싱 정보를 확인하면서 어떤 테이블부터 읽고 어떤 인덱스를 이용해 테이블을 읽을지 결정한다.  (실행 계획 수립)
3. 두 번째 단계에서 결정된 테이블의 읽기 순서나 선택된 인덱스를 이용해 스토리지 엔진으로부터 데이터를 가져온다.

<mark style="background-color:blue;">첫 번째 단계는 MySQL 서버의 "SQL 파서" 라는 모듈로 처리한다. MySQL 서버는 SQL 문장 그 자체가 아니라 SQL 파스 트리를 이용해 쿼리를 실행한다.</mark> \
\
<mark style="background-color:blue;">두 번째 단계는 SQL 파스 트리를 참조하면서 다음과 같은 내용을 처리한다. 두 번째 단계는 "최적화 및 실행계획 수립" 단계이며, MySQL 서버의 "옵티마이저" 에서 처리한다</mark>. 두 번째 단계가 완료되면 쿼리의 "실행 계획"이 만들어진다.

* 불필요한 조건 및 복잡한 연산의 단순화
* 여러 테이블의 조인이 있는 경우 어떤 순서로 테이블을 읽을지 결정
* 각 테이블에 사용된 조건과 인덱스 통계 정보를 이용해 사용할 인덱스 결정
* 가져온 레코드들을 임시 테이블에 넣고 다시 한번 가공해야 하는지 결정
* ...

<mark style="background-color:blue;">세 번째 단계는 수립된 실행 계획대로 스토리지 엔진에 레코드를 읽어오도록 요청하고, MySQL 엔진에서는 스토리지 엔진으로부터 받은 레코드를 조인하거나 정렬하는 작업을 수행</mark>한다.&#x20;
