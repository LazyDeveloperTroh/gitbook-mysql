---
description: 정렬을 처리하는 방법은 인덱스를 이용하는 방법과 쿼리가 실행될 때 "Filesort" 라는 별도의 처리를 이용하는 방법으로 나눌 수 있다.
---

# ORDER BY

<table><thead><tr><th width="150"> </th><th>장점</th><th>단점</th><th data-hidden></th></tr></thead><tbody><tr><td>인덱스 이용</td><td><ul><li>인덱스는 정렬된 상태를 유지하기 때문에 정렬 처리가 매우 빠르다</li></ul></td><td><ul><li>DML 수행 시 부가적인 인덱스 추가/삭제 작업이 필요하다</li><li>인덱스로 인해 디스크 공간이 더 필요하다</li></ul></td><td></td></tr><tr><td>Filesort 이용</td><td><ul><li>인덱스의 단점이 장점</li></ul></td><td><ul><li>레코드 대상 건수가 많아질수록 쿼리의 응답 속도가 느리다.</li></ul></td><td></td></tr></tbody></table>

<mark style="background-color:blue;">인덱스를 이용하면 빠른 정렬 처리가 가능하지만 다음과 같은 사유로 모든 정렬을 인덱스로 처리하기는 어려움이 있다.</mark> 인덱스를 이용하지 않고 별도의 정렬 처리를 수행했는지는 실행 계획의 Extra 칼럼에 "Using filesort" 메세지가 표시되는지 여부로 판단할 수 있다.

* 정렬 기준이 너무 많아서 요건별로 모두 인덱스를 생성하는 것이 불가능한 경우
* GROUP BY 결과 또는 DISTINCT 같은 처리의 결과를 정렬해야 하는 경우
* UINION의 결과와 같이 임시 테이블의 결과를 다시 정렬해야 하는 경우
* 랜덤하게 결과 레코드를 가져와야 하는 경우



### 소트 버퍼

<mark style="background-color:blue;">MySQL은 정렬을 수행하기 위해 별도의 메모리 공간을 할당받아서 사용하는데, 이 메모리 공간을 소트 버퍼라고 한다.</mark> 소트 버퍼는 정렬이 필요한 경우에만 할당되며 쿼리 실행이 완료되면 즉시 시스템으로 반납된다.\
\
<mark style="background-color:blue;">만약 정렬해야 할 레코드의 건수가 소트 버퍼로 할당된 공간보다 크다면 어떻게 동작할까? 이러한 경우 MySQL은 정렬해야 할 레코드를 여러 조각으로 나눠서 처리하는데, 이 과정에서 임시 저장을 위해 디스크를 사용한다.</mark>\
\
MySQL은 글로벌 메모리 영역과 세션 메모리 영역으로 나눠서 생각할 수 있는데 소트 버퍼는 세션 메모리 영역에 해당한다. 때문에 커넥션이 많으면 많을수록, 정렬 작업이 많으면 많을수록 소트 버퍼로 소비되는 ㅁ메모리 공간이 커짐을 의미한다. 때문에 소트 버퍼를 너무 크게 설정(10MB ↑) 메모리 부족 현상을 겪을 수 있다.
